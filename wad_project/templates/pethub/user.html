{% extends "pethub/base.html" %}
{% load staticfiles %}

{% block title_block %}
	User - {{user.username}}
{% endblock %}

{% block body_block %}
<div id="mainBody">
	<div id="user_info">
	<div id="photoFrame">
		<!-- check user is currently the one logged in -->
		{% if user.userprofile.userPicture %}
		<img width="200" height="200" src="{{ MEDIA_URL }}{{userProfile.userPicture}}" alt="{{user.username}}'s profile picture"/>
		{% else %}
		<img width="200" height="200" src="{% static 'images/user_profile/NoImageAvailable.png' %}" alt="{{user.username}}'s profile picture"/>
		{% endif %}
	</div>
	<div id="infoFrame">

		<h2>{{user.first_name}} {{user.last_name}}</h2>

		<p>{{userProfile.bio}}</p>

		{% if user == request.user %}
		<div>
			<form action="{% url 'update-user' %}">
				<input type="submit" value="Update Profile" class="equidistant"/>
			</form>
			<a  id="user_deletion_button" class="button_link" href="{% url 'confirm_user_deletion' user.id %}">Delete User</a>
		</div>
		{% endif %}

	</div>
	</div>
	{% if userPosts %}
	<div id="historic_posts">
		<h2>Historic Posts: </h2>
		{% for post in userPosts %}
		<div class="post_container">

			<div class="post_title">
				<h3>{{post.title}}</h3>
			</div>

					{% if post.picture %}
			<div class="post_image">	
				<img width="200px" height="auto" src="{{ MEDIA_URL }}{{post.picture}}" alt="Post image">
				</div>
					{% endif %}


				<div class="post_description">
					<p>{{post.description}} - posted by <a href="{% url 'user_profile' %}{{ post.user.username }}">{{post.user.username}}</a> at {{post.upload_date}}</p>
				</div>

				<div class="post_tags">
					<p>Tags: 
						{% if not post.tags.all %}
							No tags assigned
						{% else %}
							{% for tag in post.tags.all %}
									{{ tag.name }}
							{% endfor %}
						{% endif %}
					</p>
				</div>
				<div class="comments_container">
					<h3>Comments</h3>
						{% if post.comments.all %}
							{% for comment in post.comments.all %}
								<p>{{comment.comment_text}} - posted by <a href="{% url 'user_profile' %}{{ comment.user.username }}">{{comment.user.username}}</a> at {{comment.upload_date}}</p></br>
							{% endfor %}
						{% else %}
							<p>No comments to show.</p>
						{% endif %}
						<a class="button_link" href="{% url 'add_comment' %}{{ post.id }}">Add a comment</a>
					</div>
				<div class="post_likes">
					<p>
						<strong class="like_count" data-postid="{{post.id}}">{{post.likes}}</strong> people like this post
					</p>
				</div>

					{% if user.is_authenticated %}
					
						<button class="likes-button" data-postid="{{post.id}}"
																	class="btn btn-primary btn-sm" type="button">Like</button>
						
						{% if request.user == user %}
							<a id="delete_link" class="button_link" href="{% url 'delete_post' post.id %}">Delete Post</a>
						{% endif %}
									
					{% endif %}

			</div>
		{% endfor %}
		</div>
	{% else %}
		<h2>There are no historic posts by this user to show.</h2>
	{% endif %}

{% endblock %}